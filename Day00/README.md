# Day 00

## Реляционная модель данных и SQL

Работа с реляционной моделью и получение необходимых данных на основе базовых конструкций SQL.

## Introduction

- Для написания программ использовалась версия 15.2 PostgreSQL.
- Исходный код писался в DataGrip IDE.

## Contents

1. [Exercise 00](#exercise-00)
2. [Exercise 01](#exercise-01)
3. [Exercise 02](#exercise-02)
4. [Exercise 03](#exercise-03)
5. [Exercise 04](#exercise-04)
6. [Exercise 05](#exercise-05)
7. [Exercise 06](#exercise-06)
8. [Exercise 07](#exercise-07)
9. [Exercise 08](#exercise-08)
10. [Exercise 09](#exercise-09)

## Rules of the day

- Убедитесь, что у вас есть собственная база данных и доступ к ней PostgreSQL.
- Загрузите [скрипт](materials/model.sql) с моделью базы данных здесь и примените его к своей базе данных.
- Логическое представление предоставленной модели базы данных:

![schema](misc/images/schema.png)


1. **pizzeria** (Таблица с доступными пиццериями)
- поле id - первичный ключ
- поле name - название пиццерий
- поле rating - средний рейтинг пиццерии (от 0 до 5 баллов)
2. **person** (Таблица с людьми, которые любят пиццу)
- поле id - первичный ключ
- поле name - имя человека
- поле age - возраст человека
- поле gender - половая принадлежность человека
- поле address - адрес человека
3. **menu** (Таблица с доступным меню и ценой на конкретную пиццу)
- поле id - первичный ключ
- поле pizzeria_id - внешний ключ от таблицы пиццерий
- поле pizza_name - название пиццы в пиццерии
- поле price - цена конкретной пиццы
4. **person_visits** (Таблица с информацией о посещениях пиццерии)
- поле id - первичный ключ
- поле person_id - внешний ключ от таблицы с людьми
- поле pizzeria_id - внешний ключ от таблицы пиццерий
- поле visit_date - дата (например: 01.01.2022) посещения человека
5. **person_order** (Таблица с информацией о заказах людей)
- поле id - первичный ключ
- поле person_id - внешний ключ от таблицы с людьми
- поле menu_id - внешний ключ от таблицы с меню
- поле order_date - дата (например: 01.01.2022) заказа человека

Посещение человека и заказ человека являются разными сущностями и не содержат никакой корреляции между данными. Например, клиент может находиться в одном ресторане (просто просматривая меню), а в это время сделать заказ в другом по телефону или через мобильное приложение. Или другой случай, просто оказаться дома и снова позвонить с заказом без всяких посещений.

## Exercise 00

- Программа расположена в директории: ex00;
- Файл для сдачи: `day00_ex00.sql`;
- Языки: ANSI SQL.

Написан оператор выбора, который возвращает все имена и возраст людей из города «Казань».

## Exercise 01

- Программа расположена в директории: ex01;
- Файл для сдачи: `day00_ex01.sql`;
- Языки: ANSI SQL.

Написан оператор выбора, который возвращает имена и возраст всех женщин из города «Казань». Результаты отсортированы по имени.

## Exercise 02

- Программа расположена в директории: ex02;
- Файл для сдачи: `day00_ex02.sql`;
- Языки: ANSI SQL.

Созданы два синтаксических оператора выбора, которые возвращают список пиццерий (название и рейтинг пиццерии) с рейтингом от 3,5 до 5 баллов (включая предельные баллы), упорядоченных по рейтингу пиццерии.
- первый оператор выбора содержит знаки сравнения (<=, >=)
- второй оператор выбора содержит ключевое слово `BETWEEN`.

## Exercise 03

- Программа расположена в директории: ex03;
- Файл для сдачи: `day00_ex03.sql`;
- Языки: ANSI SQL.

Написан оператор выбора, который возвращает идентификаторы человека (без дублирования), который посетил пиццерии в период с 6 января 2022 года по 9 января 2022 года (включая все дни) или посетил пиццерию с идентификатором 2. Также включено упорядочивание по идентификатору человека в нисходящий режим.

## Exercise 04

- Программа расположена в директории: ex04;
- Файл для сдачи: `day00_ex04.sql`;
- Языки: ANSI SQL.

Создан оператор выбора, который возвращает одно вычисленное поле с именем «`person_information`» в одной строке, как описано в следующем примере:

`Anna (age:16,gender:'female',address:'Moscow')`

Добавлено упорядочивание по вычисляемому столбцу в порядке возрастания.

## Exercise 05

- Программа расположена в директории: ex05;
- Файл для сдачи: `day00_ex05.sql`;
- Языки: ANSI SQL.

**Недопустимо**
- SQL синтаксические конструкции: IN, любые типы JOIN.

Создан оператор выбора, который возвращает имена людей (на основе внутреннего запроса в предложении `SELECT`), которые сделали заказы на меню с идентификаторами 13, 14 и 18, а дата заказов должна быть равна 7 января 2022 года. Обратите внимание на «Недопустимо».

Шаблон внутреннего запроса:

    SELECT 
	    (SELECT ... ) AS NAME  -- this is an internal query in a main SELECT clause
    FROM ...
    WHERE ...

## Exercise 06

- Программа расположена в директории: ex06;
- Файл для сдачи: `day00_ex06.sql`;
- Языки: ANSI SQL.

**Недопустимо**
- SQL синтаксические конструкции: IN, любые типы JOIN.

Использована конструкция SQL из упражнения 05 и добавлен новый вычисляемый столбец (имя столбца «`check_name`») с оператором проверки (псевдокод для этой проверки представлен ниже) в предложении «`SELECT`».

    if (person_name == 'Denis') then return true
        else return false

## Exercise 07

- Программа расположена в директории: ex07;
- Файл для сдачи: `day00_ex07.sql`;
- Языки: ANSI SQL.

**Недопустимо**
- SQL синтаксические конструкции: IN, любые типы JOIN.

Применила интервалы данных для таблицы person.
Создан оператор SQL, который возвращает идентификаторы человека, имена человека и интервал возраста человека (задано имя нового вычисляемого столбца как «`interval_info`») на основе приведенного ниже псевдокода.

    if (age >= 10 and age <= 20) then return 'interval #1'
    else if (age > 20 and age < 24) then return 'interval #2'
    else return 'interval #3'

Результат отсортирован по столбцу «`interval_info`» в порядке возрастания.

## Exercise 08

- Программа расположена в директории: ex08;
- Файл для сдачи: `day00_ex08.sql`;
- Языки: ANSI SQL.

Создан оператор SQL, который возвращает все столбцы из таблицы `person_order` со строками, идентификатор которых представляет собой четное число. Результат упорядочен по возвращаемому идентификатору.

## Exercise 09

- Программа расположена в директории: ex09;
- Файл для сдачи: `day00_ex09.sql`;
- Языки: ANSI SQL.

**Недопустимо**
- SQL синтаксические конструкции: любые типы JOIN.

Создан оператор выбора, который возвращает имена людей и названия пиццерий на основе таблицы `person_visit` с датой посещения в период с 7 по 9 января 2022 года (включая все дни) (на основе внутреннего запроса в предложении `FROM`).

Шаблон окончательного запроса.

    SELECT (...) AS person_name ,  -- this is an internal query in a main SELECT clause
            (...) AS pizzeria_name  -- this is an internal query in a main SELECT clause
    FROM (SELECT … FROM person_visits WHERE …) AS pv -- this is an internal query in a main FROM clause
    ORDER BY ...

Добавлено упорядочивание по имени человека в порядке возрастания и по названию пиццерии в порядке убывания.
